<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        canvas {
            box-shadow: 0px 0px 5px #ccc;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <canvas id="canvas" width="900" height="900"></canvas>
    <div>
        <button onclick="btnClick()">划线</button>
        <button onclick="clearCanvas()">清除</button>
        <button onclick="drawRect()">画矩形</button>
        <button onclick="drawCircle()">画圆</button>
        <button onclick="drawImage()">画图</button>
        <button onclick="openCustomDrawReact()">自定义画圈</button>
        <button onclick="drawTrigon()">画三角形</button>
        <button onclick="drawArc()">画圆弧</button>
        <button onclick="drawBezier()">画贝塞尔曲线</button>
        <button onclick="imgClip()">图片裁剪</button>

    </div>
</body>
<script>
    var points = [
    {
        "x": 380.2669667389433,
        "y": 874.5495671452703
    },
    {
        "x": 379.36652542372883,
        "y": 874.5495671452703
    },
    {
        "x": 377.25053845421746,
        "y": 874.5495671452703
    },
    {
        "x": 372.9195091118247,
        "y": 874.6756756756757
    },
    {
        "x": 367.10275423728814,
        "y": 876.0450802364866
    },
    {
        "x": 360.3946062508276,
        "y": 879.1351351351352
    },
    {
        "x": 352.84906419657045,
        "y": 883.198215793919
    },
    {
        "x": 345.8257591118247,
        "y": 888.4414590371622
    },
    {
        "x": 339.35170370845475,
        "y": 894.4864864864866
    },
    {
        "x": 333.4989406779661,
        "y": 900.8288640202703
    },
    {
        "x": 329.0778777558925,
        "y": 907.4594594594595
    },
    {
        "x": 325.1340218236891,
        "y": 914.198215793919
    },
    {
        "x": 321.28919491525426,
        "y": 921.450485641892
    },
    {
        "x": 317.3093308270988,
        "y": 930.3153505067568
    },
    {
        "x": 313.2214158914857,
        "y": 939.8198374155406
    },
    {
        "x": 309.1424963999603,
        "y": 949.3964315878379
    },
    {
        "x": 305.0185469287937,
        "y": 959.6486486486486
    },
    {
        "x": 301.78601694915255,
        "y": 969.6307010135135
    },
    {
        "x": 299.3728901491327,
        "y": 979.5496199324325
    },
    {
        "x": 297.91420370845475,
        "y": 989.4054054054054
    },
    {
        "x": 297.4820003186242,
        "y": 999.2883234797298
    },
    {
        "x": 297.4820003186242,
        "y": 1010.3783783783784
    },
    {
        "x": 297.4820003186242,
        "y": 1022.6307010135135
    },
    {
        "x": 298.760593220339,
        "y": 1034.6756756756756
    },
    {
        "x": 301.87607690843487,
        "y": 1045.7748099662163
    },
    {
        "x": 306.11707267114673,
        "y": 1056.945945945946
    },
    {
        "x": 312.03285656945184,
        "y": 1069.2972972972973
    },
    {
        "x": 318.9931144067797,
        "y": 1081.1351351351352
    },
    {
        "x": 325.23305084745766,
        "y": 1090.5766469594596
    },
    {
        "x": 331.13983930167507,
        "y": 1098.7477829391892
    },
    {
        "x": 337.53285656945184,
        "y": 1106.4415118243244
    },
    {
        "x": 344.36707267114673,
        "y": 1113.1712415540542
    },
    {
        "x": 352.9841277558925,
        "y": 1119.3513513513515
    },
    {
        "x": 362.89779301012976,
        "y": 1124.6667018581081
    },
    {
        "x": 372.8294491525424,
        "y": 1127.945945945946
    },
    {
        "x": 385.07522945080774,
        "y": 1130.9369721283783
    },
    {
        "x": 396.89777542372883,
        "y": 1133.8288640202704
    },
    {
        "x": 408.0450299796412,
        "y": 1135.3063766891892
    },
    {
        "x": 422.3347809355138,
        "y": 1136.3694045608108
    },
    {
        "x": 435.3908898305085,
        "y": 1136.9009712837837
    },
    {
        "x": 446.84427966101697,
        "y": 1136.9009712837837
    },
    {
        "x": 458.0905896202993,
        "y": 1136.2702702702704
    },
    {
        "x": 467.2929025423729,
        "y": 1134.1531883445946
    },
    {
        "x": 475.2436616541976,
        "y": 1131.1891891891892
    },
    {
        "x": 482.49209025754766,
        "y": 1127.7388091216217
    },
    {
        "x": 489.36228813559325,
        "y": 1123.6307010135135
    },
    {
        "x": 495.31410656945184,
        "y": 1119.1531883445946
    },
    {
        "x": 500.4104872881356,
        "y": 1113.8739442567569
    },
    {
        "x": 506.3082802982654,
        "y": 1105.7207559121623
    },
    {
        "x": 512.3141241558528,
        "y": 1096.4864864864865
    },
    {
        "x": 517.7256355932203,
        "y": 1087.3513513513515
    },
    {
        "x": 522.8310381355932,
        "y": 1077.0901604729731
    },
    {
        "x": 527.8824152542373,
        "y": 1066.396431587838
    },
    {
        "x": 532.3305436473782,
        "y": 1056.4594594594596
    },
    {
        "x": 535.8331743660619,
        "y": 1047.8739442567569
    },
    {
        "x": 538.5974927999206,
        "y": 1040.396431587838
    },
    {
        "x": 540.3803317829714,
        "y": 1034.6486486486488
    },
    {
        "x": 541.8930436473782,
        "y": 1029.9279983108108
    },
    {
        "x": 543.0365466101695,
        "y": 1025.3874577702704
    },
    {
        "x": 543.8559497897908,
        "y": 1019.9009712837839
    },
    {
        "x": 544.6933438575874,
        "y": 1013.9279983108108
    },
    {
        "x": 545.5037252135196,
        "y": 1007.8558910472974
    },
    {
        "x": 546.2961156812765,
        "y": 1001.2702702702703
    },
    {
        "x": 546.6832627118645,
        "y": 994.7207559121622
    },
    {
        "x": 546.6832627118645,
        "y": 987.4054054054054
    },
    {
        "x": 546.6832627118645,
        "y": 979.504539695946
    },
    {
        "x": 546.6832627118645,
        "y": 972.2523226351352
    },
    {
        "x": 546.4671610169491,
        "y": 966.1171875
    },
    {
        "x": 545.5127470372087,
        "y": 961.3964315878379
    },
    {
        "x": 543.7569207660223,
        "y": 957.2883234797298
    },
    {
        "x": 541.6229165287341,
        "y": 953.3243243243244
    },
    {
        "x": 539.3898305084746,
        "y": 949.6307010135135
    },
    {
        "x": 536.4004413152145,
        "y": 945.8648648648649
    },
    {
        "x": 532.582627118644,
        "y": 942
    },
    {
        "x": 528.0985169491526,
        "y": 937.5135135135135
    },
    {
        "x": 522.4979165287341,
        "y": 932.0270270270271
    },
    {
        "x": 516.5010944948358,
        "y": 926.9639991554054
    },
    {
        "x": 510.83739406779665,
        "y": 922.5495671452703
    },
    {
        "x": 504.9756355932204,
        "y": 918.3423775337839
    },
    {
        "x": 499.0238699185646,
        "y": 914.6576752533784
    },
    {
        "x": 493.270162291446,
        "y": 911.279296875
    },
    {
        "x": 487.5704800880562,
        "y": 908.0991342905406
    },
    {
        "x": 482.5280720338983,
        "y": 905.3603779560812
    },
    {
        "x": 478.40414894233317,
        "y": 903.1261613175676
    },
    {
        "x": 474.30723856263245,
        "y": 901.2702702702703
    },
    {
        "x": 469.8050847457627,
        "y": 899.3874049831081
    },
    {
        "x": 465.2939618644068,
        "y": 897.5225401182433
    },
    {
        "x": 460.2695974576271,
        "y": 895.972972972973
    },
    {
        "x": 455.2362639863612,
        "y": 894.4234586148649
    },
    {
        "x": 450.7251411050053,
        "y": 892.918918918919
    },
    {
        "x": 446.21401822364936,
        "y": 891.4144320101352
    },
    {
        "x": 441.68485169491527,
        "y": 889.9009184966217
    },
    {
        "x": 437.4708686440678,
        "y": 888.4144320101352
    },
    {
        "x": 433.37395826436705,
        "y": 886.9369721283784
    },
    {
        "x": 429.781267586401,
        "y": 885.5405405405406
    },
    {
        "x": 426.93591101694915,
        "y": 884.477512668919
    },
    {
        "x": 424.52281059653075,
        "y": 883.0901076858108
    },
    {
        "x": 421.7044667389433,
        "y": 881.3243243243244
    },
    {
        "x": 418.54397945080774,
        "y": 879.5856207770271
    },
    {
        "x": 415.9147245762712,
        "y": 877.945945945946
    },
    {
        "x": 413.6637004270392,
        "y": 876.7297297297298
    },
    {
        "x": 412.3580684338586,
        "y": 875.891891891892
    },
    {
        "x": 411.655737925384,
        "y": 875.3694045608108
    },
    {
        "x": 411.2145127118644,
        "y": 875.0810810810812
    },
    {
        "x": 410.9083774372683,
        "y": 875.0180532094595
    },
    {
        "x": 410.62925487453657,
        "y": 875.0180532094595
    },
    {
        "x": 410.3771186440678,
        "y": 875.0180532094595
    },
    {
        "x": 410.061987925384,
        "y": 874.7117293074325
    },
    {
        "x": 408.94544491525426,
        "y": 874.0630806587839
    },
    {
        "x": 406.9104960813361,
        "y": 873.0540540540541
    },
    {
        "x": 404.6324328406383,
        "y": 871.8108108108108
    },
    {
        "x": 401.6520127118644,
        "y": 870.5675675675676
    },
    {
        "x": 401.2918520135395,
        "y": 870.279296875
    },
    {
        "x": 400.72458506438693,
        "y": 869.9910261824325
    }
]
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const btnClick = () => {
        ctx.moveTo(0, 0);
        ctx.lineTo(200, 100);
        ctx.stroke();
    }
    const clearCanvas = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }
    // 画矩形
    const drawRect = () => {
        ctx.fillStyle = 'red';
        ctx.fillRect(10, 10, 100, 100);
    }
    const drawCircle = () => {
        ctx.beginPath();
        ctx.arc(200, 200, 50, 0, 2 * Math.PI);
        ctx.stroke();
    }
    const drawImage = () => {
        const img = new Image();
        img.src = 'https://www.baidu.com/img/PCtm_d9c8750bed0b3c7d089fa7d55720d6cf.png';
        img.onload = () => {
            ctx.drawImage(img, 0, 0, 200, 100);
        }
    }
    // 开启自定义画矩形
    const openCustomDrawReact = () => {
        let isDraw = false;
        let startX = 0;
        let startY = 0;
        let endX = 0;
        let endY = 0;
        canvas.addEventListener('mousedown', (e) => {
            isDraw = true;
            startX = e.offsetX;
            startY = e.offsetY;
        })
        canvas.addEventListener('mousemove', (e) => {
            if (isDraw) {
                endX = e.offsetX;
                endY = e.offsetY;
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.strokeRect(startX, startY, endX - startX, endY - startY);
            }
        })
        canvas.addEventListener('mouseup', (e) => {
            isDraw = false;
        })
    }
    // 绘制三角形
    const drawTrigon = () => {
        ctx.beginPath();
        ctx.moveTo(100, 100);
        ctx.lineTo(200, 100);
        ctx.lineTo(150, 150);
        ctx.closePath();
        ctx.stroke();
    }
    // 画圆弧
    const drawArc = () => {
        ctx.beginPath();
        ctx.arc(200, 200, 50, 0, Math.PI);
        ctx.stroke();
    }
    // 画贝塞尔曲线
    const drawBezier = () => {
        ctx.beginPath();
        ctx.moveTo(100, 100);
        ctx.quadraticCurveTo(150, 200, 300, 100);
        ctx.stroke();
        ctx.closePath();

        ctx.beginPath();
        ctx.moveTo(100, 100);
        ctx.bezierCurveTo(150, 50, 250, 200, 300, 100);
        ctx.stroke();
        ctx.closePath();
    }
    // 图片裁剪
    const imgClip = () => {
        const img = new Image();
        img.src = '../00_images/react-lifecycle.png';
        img.onload = () => {
            ctx.drawImage(img, 0, 0, 900, 900);
        }
        // setTimeout(() => {
        //     ctx.beginPath();
        //     for (let i = 0; i < points.length; i++) {
        //         const element = points[i];
        //         if (i === 0) {
        //             ctx.moveTo(element.x, element.y - 400);
        //         } else {
        //             ctx.lineTo(element.x, element.y - 400);
        //         }
        //     }
        //     ctx.closePath();
        //     ctx.clip();
        //     console.log(canvas.toDataURL());
        // }, 10);
    }
    let startDraw = false;
    // 监听鼠标按下事件
    canvas.addEventListener('mousedown', (e) => {
        console.log(e);
        startDraw = true;
        ctx.beginPath();
        ctx.moveTo(e.offsetX, e.offsetY);
    })
    // 监听鼠标移动事件
    canvas.addEventListener('mousemove', (e) => {
        if (startDraw) {
            console.log(e);
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
        }
    })
    // 监听鼠标抬起事件
    canvas.addEventListener('mouseup', (e) => {
        if (startDraw) {
            console.log(e);
            startDraw = false;
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
            ctx.closePath();

            setTimeout(() => {
                ctx.beginPath();
                for (let i = 0; i < points.length; i++) {
                    const element = points[i];
                    if (i === 0) {
                        ctx.moveTo(element.x, element.y - 400);
                    } else {
                        ctx.lineTo(element.x, element.y - 400);
                    }
                }
                ctx.closePath();
                ctx.clip();
                console.log(canvas.toDataURL());
            }, 10);
        }
    })
</script>
</html>